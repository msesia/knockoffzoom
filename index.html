<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>KnockoffZoom</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.0.13/css/fa-svg-with-js.css" rel="stylesheet" />
<script src="site_libs/font-awesome-5.0.13/js/fontawesome-all.min.js"></script>
<script src="site_libs/font-awesome-5.0.13/js/fa-v4-shims.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">KnockoffZoom</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="https://msesia.shinyapps.io/knockoffzoom/">
    <span class="fa fa-dna"></span>
     
    UK Biobank
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="mailto:msesia@stanford.edu">
    <span class="fa fa-envelope-o"></span>
     
    Contact
  </a>
</li>
<li>
  <a href="https://github.com/msesia/knockoffzoom">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">KnockoffZoom</h1>

</div>


<p>KnockoffZoom is a powerful and versatile statistical method for the analysis of genome-wide association data.</p>
<div id="overview" class="section level2">
<h2>Overview</h2>
<p>The goal of <em>KnockoffZoom</em> is to identify causal variants for complex traits effectively and precisely through genome-wide fine-mapping, accounting for linkage disequilibrium and controlling the false discovery rate. The results leverage the genetic models used for phasing and are equally valid for quantitative and binary traits. For more information, read the accompanying paper.</p>
<p>The code contained in this repository is designed to allow the application of <em>KnockoffZoom</em> to large datasets, such as the <a href="https://www.ukbiobank.ac.uk/">UK Biobank</a>. Some of the code is provided in the form of Bash and R scripts, while the core algorithms for Monte Carlo knockoff sampling are implemented in the R package <a href="https://bitbucket.org/msesia/snpknock">SNPknock</a>, which should be installed separately.</p>
<p>The <em>KnockoffZoom</em> methodology is divided into different modules, each corresponding to a separate Bash script, as summarized in the following flowchart.</p>
<div class="figure">
<img src="images/flowchart.png" title="KnockoffZoom flowchart" alt="KnockoffZoom flowchart" />
<p class="caption">KnockoffZoom flowchart</p>
</div>
</div>
<div id="toy-dataset" class="section level2">
<h2>Toy dataset</h2>
<p>A toy dataset containing 1000 artificial samples typed at 2000 loci (divided between chromosome 21 and 22) is offered as an example in which the <em>KnockoffZoom</em> analysis can be carried out on a laptop with a single click. To run the example, install the software dependencies listed below and execute the script <code>analyze.sh</code>. The analysis should take approximately 5 minutes on a personal computer. The results can be visualized interactively with the script <code>visualize.sh</code>, which will launch a <a href="https://shiny.rstudio.com/">Shiny</a> app in your browser.</p>
</div>
<div id="real-applications" class="section level2">
<h2>Real applications</h2>
<p><em>KnockoffZoom</em> is computationally efficient and we have successfully applied it to the analysis of the genetic data in the UK Biobank. The computational resources required for this task are summarized in the accompanying paper. The modular nature of our method allows the code contained in each of the 5 main scripts to be easily deployed on a computing cluster for large-scale applications. This task will require some additional user effort compared to the toy example, but the scripts for each module are documented and quite intuitive.</p>
</div>
<div id="software-dependencies" class="section level2">
<h2>Software dependencies</h2>
<p>The following software should be available from your Unix path:</p>
<ul>
<li><a href="https://www.cog-genomics.org/plink/1.9/">PLINK 1.9</a></li>
<li><a href="https://www.cog-genomics.org/plink/2.0/">PLINK 2.0</a> alpha</li>
<li><a href="http://scheet.org/software.html">fastPHASE</a> 1.4.8</li>
<li><a href="https://www.gnu.org/software/datamash/">GNU datamash</a> 1.3</li>
<li><a href="https://github.com/onetrueawk/awk">GNU awk</a> 4.0.2</li>
<li><a href="https://www.gnu.org/software/coreutils/">GNU Core Utilities</a> 8.22</li>
</ul>
<p>The <a href="https://www.r-project.org/">R</a> (version 3.5.1) code was tested on the following configuration:</p>
<ul>
<li><a href="https://bitbucket.org/msesia/snpknock">SNPknock</a> 0.8.1</li>
<li><a href="https://CRAN.R-project.org/package=adjclust">adjclust</a> 0.5.6</li>
<li><a href="https://privefl.github.io/bigsnpr/">bigsnpr</a> 0.9.1</li>
<li><a href="https://privefl.github.io/bigstatsr/">bigstatsr</a> 0.8.4</li>
<li><a href="https://doi.org/doi:10.18129/B9.bioc.snpStats">snpStats</a> 1.32</li>
<li><a href="https://CRAN.R-project.org/package=Matrix">Matrix</a> 1.2.15</li>
<li><a href="https://CRAN.R-project.org/package=data.table">data.table</a> 1.12.0</li>
<li><a href="https://www.tidyverse.org/">tidyverse</a> 1.2.1</li>
<li><a href="https://CRAN.R-project.org/package=devtools">devtools</a> 1.13.6</li>
</ul>
</div>
<div id="authors" class="section level2">
<h2>Authors</h2>
<ul>
<li><a href="http://web.stanford.edu/~msesia/">Matteo Sesia</a> (Stanford University).</li>
</ul>
</div>
<div id="contributors" class="section level2">
<h2>Contributors</h2>
<ul>
<li><a href="http://web.stanford.edu/~ekatsevi/">Eugene Katsevich</a> (Stanford University). User interface of the Shiny visualization app.</li>
</ul>
</div>
<div id="license" class="section level2">
<h2>License</h2>
<p>This software is distributed under the <a href="https://www.gnu.org/licenses/gpl-3.0.en.html">GPLv3 license</a> and it comes with ABSOLUTELY NO WARRANTY.</p>
</div>
<div id="further-references" class="section level2">
<h2>Further references</h2>
<p>Read more about the broader framework of <a href="https://web.stanford.edu/group/candes/knockoffs/">knockoffs</a>.</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
